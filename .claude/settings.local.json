{
  "permissions": {
    "allow": [
      "Bash(ls:*)",
      "Bash(cat:*)",
      "mcp__postgres__query",
      "Bash(grep:*)",
      "Bash(find:*)",
      "Bash(.claude/hooks/run-silent.sh:*)",
      "Bash(/Users/jonasstenberg/Development/Private/recept/.claude/hooks/run-silent.sh:*)",
      "Bash(wc:*)",
      "Bash(/Users/jonasstenberg/Development/Private/recept/.claude/hooks/run-api-tests.sh:*)"
    ]
  },
  "enableAllProjectMcpServers": true,
  "enabledMcpjsonServers": [
    "postgres"
  ],
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/wrap-pnpm.sh\""
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "ExitPlanMode",
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/suggest-plan-review.sh\""
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/run-silent.sh\" \"Lint\" \"pnpm lint\""
          },
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/run-silent.sh\" \"Tests\" \"pnpm test --run\""
          },
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/run-api-tests.sh\""
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/analyze-for-tests.sh\""
          },
          {
            "type": "prompt",
            "prompt": "You are evaluating whether tests should be written for code changes. The output above shows files changed and key logic additions.\n\nIf the output shows NO_CODE_CHANGES, NO_LOGIC_CHANGES, or is empty, respond:\n{\"ok\": true, \"reason\": \"No code changes requiring tests\"}\n\nAnalyze if tests would bring VALUE. Tests are valuable when:\n- New utility functions with logic (parsing, transformations, calculations)\n- Complex business logic or algorithms\n- Edge cases that are easy to get wrong\n- Code that will be reused across the codebase\n\nTests are NOT valuable for:\n- Simple React components (UI rendering, styling)\n- Thin wrappers or pass-through functions\n- Configuration or constants\n- Code that's mostly type definitions\n- Already trivial code\n- When existing tests already cover the logic\n\nProject test patterns:\n- Frontend: lib/**/__tests__/*.test.ts (vitest)\n- Email service: src/__tests__/*.test.ts (vitest)\n\nIf only config/style changes, respond:\n{\"ok\": true, \"reason\": \"No valuable tests needed\"}\n\nIf valuable tests should be written, respond:\n{\"ok\": false, \"reason\": \"Tests should be written for [specific functions]. Use Task tool with subagent_type='react-frontend-dev' to write vitest tests.\"}\n\nBe selective - only block if tests genuinely add value. Most UI changes don't need tests.",
            "timeout": 30
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/analyze-for-review.sh\""
          },
          {
            "type": "prompt",
            "prompt": "You are evaluating whether code review skills should be run for the current changes.\n\nIf the output shows REVIEW_ALREADY_DONE, NO_CODE_CHANGES, or MINOR_CHANGES, respond:\n{\"ok\": true, \"reason\": \"No review needed\"}\n\nIf the output shows REVIEW_RECOMMENDED, evaluate the scope:\n\n1. If SECURITY_SENSITIVE is YES or SQL_MIGRATIONS is YES, respond:\n{\"ok\": false, \"reason\": \"Security-sensitive or database changes detected. Run check-your-work skill (say 'check your work') to validate RLS policies, SQL injection risks, and migration correctness before completing.\"}\n\n2. If FILES_CHANGED >= 5 or LINES_CHANGED >= 100, respond:\n{\"ok\": false, \"reason\": \"Substantial code changes detected ([N] files, [M] lines). Run check-your-work skill (say 'check your work') to check for bugs, then check-your-code skill (say 'check your code') for quality review.\"}\n\n3. If FILES_CHANGED >= 3 or LINES_CHANGED >= 50, respond:\n{\"ok\": false, \"reason\": \"Moderate code changes detected. Run check-your-work skill (say 'check your work') to validate the changes before completing.\"}\n\n4. Otherwise, respond:\n{\"ok\": true, \"reason\": \"Changes below review threshold\"}\n\nAfter review skills complete, touch the marker file to prevent re-triggering:\ntouch $CLAUDE_PROJECT_DIR/.claude/.last-review",
            "timeout": 30
          }
        ]
      }
    ]
  }
}
