---
phase: 01-extract-hemmet-to-standalone-page
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/frontend/components/header.tsx
  - apps/frontend/components/mobile-menu.tsx
  - apps/frontend/next.config.ts
autonomous: true

must_haves:
  truths:
    - "User finds 'Mitt hem' link in the desktop header dropdown menu"
    - "User finds 'Mitt hem' link in the mobile hamburger menu"
    - "Visiting /installningar/hemmet redirects to /hemmet (no broken bookmarks)"
  artifacts:
    - path: "apps/frontend/components/header.tsx"
      provides: "Desktop dropdown with Mitt hem link"
      contains: "Mitt hem"
    - path: "apps/frontend/components/mobile-menu.tsx"
      provides: "Mobile menu with Mitt hem link"
      contains: "Mitt hem"
    - path: "apps/frontend/next.config.ts"
      provides: "308 permanent redirect from old URL to new URL"
      contains: "/installningar/hemmet"
  key_links:
    - from: "apps/frontend/components/header.tsx"
      to: "/hemmet"
      via: "Link href"
      pattern: "href=\"/hemmet\""
    - from: "apps/frontend/components/mobile-menu.tsx"
      to: "/hemmet"
      via: "Link href"
      pattern: "href=\"/hemmet\""
    - from: "apps/frontend/next.config.ts"
      to: "/hemmet"
      via: "redirect destination"
      pattern: "destination.*hemmet"
---

<objective>
Add "Mitt hem" navigation links to both desktop and mobile menus, and configure a 308 permanent redirect from the old settings URL.

Purpose: Users need to discover and access the new standalone Home page from global navigation. Existing bookmarks to the old URL must not break. This completes the Phase 1 requirements for navigation (REQ-05) and redirect (implicit in REQ-04).

Output: Updated header.tsx with Mitt hem in desktop dropdown, updated mobile-menu.tsx with Mitt hem in mobile sheet, and next.config.ts with 308 redirect from `/installningar/hemmet` to `/hemmet`.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-extract-hemmet-to-standalone-page/01-RESEARCH.md

@apps/frontend/components/header.tsx
@apps/frontend/components/mobile-menu.tsx
@apps/frontend/next.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add "Mitt hem" link to desktop and mobile navigation</name>
  <files>
    apps/frontend/components/header.tsx
    apps/frontend/components/mobile-menu.tsx
  </files>
  <action>
    **header.tsx (desktop dropdown):**

    1. Add `Home` to the lucide-react icon imports:
       Change `import { ChefHat, LogOut, Menu, Settings, ShoppingCart, Sparkles, UtensilsCrossed, User, UserCog } from "lucide-react"`
       to `import { ChefHat, Home, LogOut, Menu, Settings, ShoppingCart, Sparkles, UtensilsCrossed, User, UserCog } from "lucide-react"`

    2. Add the "Mitt hem" link in the user dropdown menu, AFTER the Inköpslista link and BEFORE the AI-krediter link. Insert this block between the `/inkopslista` Link and the `/krediter` Link (around line 102):

       ```tsx
       <Link
         href="/hemmet"
         className="flex w-full items-center gap-2 rounded-sm px-2 py-1.5 text-sm hover:bg-accent"
         onClick={() => setUserMenuOpen(false)}
       >
         <Home className="h-4 w-4" />
         Mitt hem
       </Link>
       ```

    **mobile-menu.tsx (mobile sheet):**

    1. Add `Home` to the lucide-react icon imports:
       Change `import { LogOut, Menu, Plus, Settings, ShoppingCart, Sparkles, UtensilsCrossed, UserCog } from "lucide-react"`
       to `import { Home, LogOut, Menu, Plus, Settings, ShoppingCart, Sparkles, UtensilsCrossed, UserCog } from "lucide-react"`

    2. Add the "Mitt hem" link in the mobile nav, AFTER the Inköpslista link and BEFORE the AI-krediter link. Insert this block between the `/inkopslista` Link and the `/krediter` Link (around line 66):

       ```tsx
       <Link
         href="/hemmet"
         className="flex items-center gap-2 rounded-md px-3 py-2 text-sm font-medium hover:bg-accent"
         onClick={() => setOpen(false)}
       >
         <Home className="h-4 w-4" />
         Mitt hem
       </Link>
       ```

    Position matters: The link goes after Inköpslista and before AI-krediter in BOTH menus. This groups user-feature links together (Skafferi, Inköpslista, Mitt hem) before utility links (AI-krediter, Inställningar).
  </action>
  <verify>
    Run `pnpm build`. Build must pass. Then visually verify in `pnpm dev`:
    - Desktop: Click user dropdown -- "Mitt hem" appears between Inköpslista and AI-krediter with Home icon
    - Mobile: Open hamburger menu -- "Mitt hem" appears between Inköpslista and AI-krediter with Home icon
  </verify>
  <done>
    Both desktop dropdown and mobile menu show "Mitt hem" link with Home icon positioned between Inköpslista and AI-krediter. Links point to `/hemmet`. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure 308 permanent redirect from old URL</name>
  <files>
    apps/frontend/next.config.ts
  </files>
  <action>
    Update `apps/frontend/next.config.ts` to add a `redirects()` function that permanently redirects the old hemmet URL to the new one.

    Add the `redirects` async function to the existing nextConfig object. The final config should look like:

    ```typescript
    import type { NextConfig } from 'next'

    const nextConfig: NextConfig = {
      output: 'standalone',
      serverExternalPackages: ['sharp'],
      outputFileTracingIncludes: {
        '/*': ['node_modules/sharp/**/*'],
      },
      images: {
        formats: ['image/avif', 'image/webp'],
        deviceSizes: [640, 750, 828, 1080, 1200, 1920],
        imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
        minimumCacheTTL: 31536000,
      },

      async redirects() {
        return [
          {
            source: '/installningar/hemmet',
            destination: '/hemmet',
            permanent: true,
          },
        ]
      },
    }

    export default nextConfig
    ```

    Why `permanent: true`: Next.js translates this to HTTP 308 (not 301). 308 preserves the HTTP method -- if someone POSTs to the old URL, the redirect keeps it as POST. This is the correct behavior for permanent route changes.

    Note: Next.js handles trailing slash variants by default when `trailingSlash` is not explicitly set (current config doesn't set it). Both `/installningar/hemmet` and `/installningar/hemmet/` should redirect.
  </action>
  <verify>
    Run `pnpm build`. Build must pass. Then run `pnpm dev` and test:
    1. Visit `http://localhost:3000/installningar/hemmet` in browser -- should redirect to `/hemmet`
    2. Check browser network tab shows 308 status code on redirect
    3. Verify the redirect preserves the path correctly (lands on `/hemmet`, not 404)
  </verify>
  <done>
    Visiting `/installningar/hemmet` returns 308 redirect to `/hemmet`. Old bookmarks work. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` passes with zero errors
2. Desktop dropdown menu shows "Mitt hem" with Home icon between Inköpslista and AI-krediter
3. Mobile menu shows "Mitt hem" with Home icon between Inköpslista and AI-krediter
4. Clicking "Mitt hem" in either menu navigates to `/hemmet`
5. Visiting `/installningar/hemmet` redirects to `/hemmet` with 308 status
6. `pnpm lint` passes (Home icon imported correctly in both files)
</verification>

<success_criteria>
- "Mitt hem" link visible in desktop dropdown and mobile menu
- Link positioned correctly (after Inköpslista, before AI-krediter)
- Home icon from lucide-react renders alongside link text
- 308 redirect from `/installningar/hemmet` to `/hemmet` works
- Build and lint pass clean
</success_criteria>

<output>
After completion, create `.planning/phases/01-extract-hemmet-to-standalone-page/01-02-SUMMARY.md`
</output>
