---
phase: 01-extract-hemmet-to-standalone-page
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - apps/frontend/components/home/home-settings.tsx
  - apps/frontend/components/home/home-invite-section.tsx
autonomous: true

must_haves:
  truths:
    - "Home page displays household info, members, and invite flow in clearly separated sections (not crammed together)"
    - "User can invite a household member via join code or email without confusion about which method to use"
  artifacts:
    - path: "apps/frontend/components/home/home-settings.tsx"
      provides: "Redesigned layout with separate Card components for each section"
      contains: "CardTitle"
    - path: "apps/frontend/components/home/home-invite-section.tsx"
      provides: "Separated invite methods with clear headings and help text"
      contains: "Inbjudningslank"
  key_links:
    - from: "apps/frontend/components/home/home-settings.tsx"
      to: "Card components"
      via: "Multiple Card wrappers for each section"
      pattern: "<Card>"
    - from: "apps/frontend/components/home/home-invite-section.tsx"
      to: "HomeJoinCode"
      via: "Rendered in its own subsection with heading and description"
      pattern: "HomeJoinCode"
---

<objective>
Redesign the HomeSettings layout to use separate Card components for each logical section, and simplify the invite flow with clear separation between join code and email invite methods.

Purpose: The current HomeSettings crams everything (home name, members, invites, danger zone) into a single Card with Separator dividers. This makes the page feel dense and hard to scan. SC-03 requires "clearly separated sections" and REQ-07 requires the invite flow to not confuse users about which method to use. Breaking into separate Cards with descriptive headings solves both.

Output: Redesigned `home-settings.tsx` with 4 separate Cards (Hemmet info, Medlemmar, Bjud in, Farozon) and redesigned `home-invite-section.tsx` with clearly separated and labeled invite methods.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-extract-hemmet-to-standalone-page/01-RESEARCH.md

@apps/frontend/components/home/home-settings.tsx
@apps/frontend/components/home/home-invite-section.tsx
@apps/frontend/components/home/home-join-code.tsx
@apps/frontend/components/home/home-member-list.tsx
@apps/frontend/components/home/home-name-editor.tsx
@apps/frontend/components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Redesign HomeSettings layout with separate Card sections</name>
  <files>
    apps/frontend/components/home/home-settings.tsx
  </files>
  <action>
    Restructure `home-settings.tsx` to replace the single monolithic Card with 4 separate Card components, each with its own CardHeader (title + description) for clear visual separation.

    The current layout is:
    ```
    Card
      CardHeader: "Ditt hem" / description
      CardContent:
        HomeNameEditor
        Separator
        "Medlemmar" h3 + HomeMemberList
        Separator
        "Bjud in medlem" h3 + HomeInviteSection
        Separator
        "Farozon" h3 + HomeLeaveDialog
    ```

    Change to:
    ```
    div.space-y-6
      Card 1: Hemmet (info)
        CardHeader: title="Hemmet", description="Namn och grundinformation"
        CardContent:
          label "Hemnamn" + HomeNameEditor (same as current)

      Card 2: Medlemmar
        CardHeader: title="Medlemmar ({home.members.length})", description="Personer som delar detta hem"
        CardContent:
          HomeMemberList (same props as current)

      Card 3: Bjud in medlem
        CardHeader: title="Bjud in medlem", description="Bjud in nya medlemmar via e-post eller delningslank"
        CardContent:
          HomeInviteSection (same props as current)

      Card 4: Farozon (danger zone)
        CardHeader: title="Farozon" with text-destructive on CardTitle, description="Atgarder som inte kan angras"
        CardContent:
          p warning text (same as current) + HomeLeaveDialog (same props)
    ```

    Implementation details:
    1. Keep the outer `<div className="space-y-6">` wrapper.
    2. Remove ALL `<Separator />` imports and usage -- the Card boundaries provide visual separation.
    3. Each Card uses `<CardHeader>` with `<CardTitle>` and `<CardDescription>` for the section heading and context.
    4. Card 2 (Medlemmar): Include member count in the title: `Medlemmar ({home.members.length})`. This gives instant context about household size.
    5. Card 4 (Farozon): Add `className="text-destructive"` to the `<CardTitle>` to visually signal danger. Optionally add `className="border-destructive/20"` to the Card itself for a subtle red border.
    6. All handler functions (handleUpdateName, handleRefreshCode, handleDisableCode, handleSendInvite, handleLeaveHome, handleRemoveMember) remain EXACTLY as they are. Do NOT change any business logic.
    7. All component props remain identical. Only the layout wrapper changes.
    8. Remove the `Separator` import from the imports list since it is no longer used.

    The result: Each section is its own Card with a clear title and description, making the page easy to scan. Users immediately see what each section is for.
  </action>
  <verify>
    Run `pnpm build` from repo root. Build must pass with zero errors. Run `pnpm lint` -- must pass. Then visually verify with `pnpm dev` that `/hemmet` (or `/installningar/hemmet` before Plan 01-01 runs) shows 4 separate cards stacked vertically with clear headings.
  </verify>
  <done>
    HomeSettings renders 4 separate Cards (Hemmet, Medlemmar, Bjud in medlem, Farozon) instead of one monolithic Card. Each Card has its own CardHeader with title and description. No Separator components used. All business logic unchanged. Build and lint pass.
  </done>
</task>

<task type="auto">
  <name>Task 2: Simplify invite flow with clear method separation</name>
  <files>
    apps/frontend/components/home/home-invite-section.tsx
  </files>
  <action>
    Redesign `home-invite-section.tsx` to clearly separate the two invite methods (email and join link) with explicit headings, help text, and visual structure that eliminates confusion about which method to use.

    The current layout is:
    ```
    div.space-y-6
      div: "Via e-post" h4 + email form
      "eller" divider (horizontal line with centered text)
      div: "Dela denna lank" Label + HomeJoinCode
    ```

    The problem: "Via e-post" and "Dela denna lank" are vague labels. The "eller" divider implies mutual exclusion when both methods can be used simultaneously. Users don't understand the difference between the methods.

    Change to:
    ```
    div.space-y-8 (more spacing between methods)

      Section 1: Inbjudningslank (join code)
        h4.text-sm.font-semibold: "Inbjudningslank"
        p.text-sm.text-muted-foreground: "Skapa en lank som du kan skicka till den du vill bjuda in. Lanken ar giltig i 7 dagar."
        HomeJoinCode (same props as current)

      Section 2: Bjud in via e-post
        h4.text-sm.font-semibold: "Bjud in via e-post"
        p.text-sm.text-muted-foreground: "Skicka en inbjudan direkt till en e-postadress. Mottagaren far ett mejl med instruktioner."
        email form (same as current)
        error/success alerts (same as current)
    ```

    Implementation details:
    1. SWAP the order: Put the join link FIRST (it is the simpler, more common flow -- just generate and share a link). Put email invite SECOND (it requires knowing the exact email and triggers an email send).
    2. REMOVE the "eller" divider entirely. These are not mutually exclusive options -- both can be used. Instead, they are simply two separate subsections within the same Card (the parent Card from Task 1 already says "Bjud in medlem").
    3. Add descriptive help text (as `<p className="text-sm text-muted-foreground">`) under each heading explaining WHAT the method does and HOW it works. This is the key UX improvement.
    4. Change outer wrapper from `space-y-6` to `space-y-8` for more visual breathing room between the two methods.
    5. Change section headings from `h4.text-sm.font-medium` to `h4.text-sm.font-semibold` for slightly more visual weight.
    6. The email form markup stays identical (Input + Button in flex row, error/success alerts below).
    7. HomeJoinCode component usage stays identical (same props: joinCode, onRefresh, onDisable).
    8. All state management (email, isLoading, error, success) and the handleSendInvite function remain EXACTLY as they are.
    9. Remove the `Label` import since it is no longer used (the "Dela denna lank" Label is replaced by an h4 heading).

    The result: Users see two clearly distinct methods with explanatory text. No confusing "eller" suggesting mutual exclusion. The simpler method (link sharing) comes first.
  </action>
  <verify>
    Run `pnpm build` from repo root. Build must pass. Run `pnpm lint` -- must pass. Visually verify that the invite section within the "Bjud in medlem" card shows two clearly separated subsections: "Inbjudningslank" with help text first, then "Bjud in via e-post" with help text second. No "eller" divider present.
  </verify>
  <done>
    HomeInviteSection shows two clearly separated invite methods: join link first with descriptive help text ("Skapa en lank som du kan skicka..."), then email invite second with descriptive help text ("Skicka en inbjudan direkt..."). No confusing "eller" divider. Order is link-first (simpler) then email (more specific). Build and lint pass.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` passes with zero errors
2. `pnpm lint` passes with no warnings
3. HomeSettings renders 4 separate Cards: Hemmet, Medlemmar (with count), Bjud in medlem, Farozon
4. Each Card has CardHeader with title and description
5. Farozon Card title is styled with destructive color
6. Invite section shows join link method first with help text
7. Invite section shows email method second with help text
8. No "eller" divider between invite methods
9. All business logic unchanged -- creating/joining/leaving home, inviting members, managing join codes all work as before
</verification>

<success_criteria>
- Home page displays household info, members, and invite flow in clearly separated Card sections
- Each section has a descriptive heading and subtitle for easy scanning
- User can distinguish between join link and email invite methods without confusion
- Join link method appears first (simpler flow) with explanatory text
- Email invite method appears second with explanatory text
- No "eller" divider implying mutual exclusion
- All existing functionality preserved (no business logic changes)
- Build and lint pass clean
</success_criteria>

<output>
After completion, create `.planning/phases/01-extract-hemmet-to-standalone-page/01-03-SUMMARY.md`
</output>
